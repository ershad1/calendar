(function(){angular.module("calendarApp",["ngRoute","ui.bootstrap","angularMoment"]);function e(e,t){e.currentYear=moment().format("Y");e.currentMonth=moment().format("M")-1;e.baseUrl=t.protocol()+"://"+t.host()+":"+t.port()}function t(e,t){e.when("/:year?/:month?",{templateUrl:"/home/home.view.html",controller:"homeCtrl"});t.html5Mode(true)}function n(e){var t=io.connect();return{on:function(n,r){function a(){var n=arguments;e.$apply(function(){r.apply(t,n)})}t.on(n,a);return function(){t.removeListener(n,a)}},emit:function(n,r,a){t.emit(n,r,function(){var n=arguments;e.$apply(function(){if(a){a.apply(t,n)}})})}}}angular.module("calendarApp").config(["$routeProvider","$locationProvider",t]);angular.module("calendarApp").run(["$rootScope","$location",e]);angular.module("calendarApp").factory("socket",["$rootScope",n])})();(function(){angular.module("calendarApp").controller("homeCtrl",e);e.$inject=["$scope","socket","$rootScope","$http","$location","$routeParams"];function e(e,t,n,r,a,o){e.generateCalendar=function(t,n){e.commonData={};e.event={title:"",description:""};var r=[];var a=moment([t,n]).startOf("month").week();var o=moment([t,n]).endOf("month").week();if(n==11){var o=moment([t,n]).subtract(parseInt(t)+1-moment().format("Y"),"Y").endOf("month").week()}for(var i=a;i<=o;i++){r.push({week:i,days:Array(7).fill(0).map(function(e,r){var a=moment([t,n]).week(i).startOf("week").clone().add(e+r,"day");return{date:a.format("D"),month:a.format("M"),year:a.format("Y"),day:a.format("dddd"),events:[]}})})}e.commonData.filteredYear=t;e.commonData.filteredMonth=n;e.commonData.filteredMonthName=moment([t,n]).format("MMMM");e.weeks=r};if(o.year&&o.month){n.currentYear=o.year;n.currentMonth=o.month}e.generateCalendar(n.currentYear,n.currentMonth);r.get(n.baseUrl+"/events",{params:{year:n.currentYear,month:parseInt(n.currentMonth)+1}}).then(function(t){if(t.data.status==2e3){for(var n=0;n<t.data.data.length;n++){e.weeks[t.data.data[n].weeksIndex].days[t.data.data[n].dayIndex].events.push(t.data.data[n])}}});e.nextMonth=function(){var t=moment([e.currentYear,e.currentMonth]).add(1,"M");n.currentYear=t.format("Y");n.currentMonth=t.format("M")-1;a.path("/"+n.currentYear+"/"+n.currentMonth).replace()};e.previousMonth=function(){var t=moment([e.currentYear,e.currentMonth]).subtract(1,"M");n.currentYear=t.format("Y");n.currentMonth=t.format("M")-1;a.path("/"+n.currentYear+"/"+n.currentMonth).replace()};e.addEvent=function(t,n,r,a,o){e.event={title:"",description:""};e.triggeredCell={year:t,month:n,date:r,weeksIndex:a,dayIndex:o}};e.saveEvent=function(){e.triggeredCell.title=e.event.title;e.triggeredCell.description=e.event.description;r.post(n.baseUrl+"/events",e.triggeredCell).then(function(t){if(t.data.status==2001){e.event={title:"",description:""};jQuery("#createEventModal").modal("hide");$.notify(t.data.message,"success");return}$.notify(t.data.message,"error")})};e.viewEvent=function(t,n){e.event={title:t,description:n}};e.editEvent=function(t,n,r,a,o,i,d,c,l){e.event={title:c,description:l,_id:d};e.triggeredCell={year:t,month:n,date:r,weeksIndex:a,dayIndex:o,eventIndex:i}};e.updateEvent=function(){e.triggeredCell.title=e.event.title;e.triggeredCell.description=e.event.description;r.put(n.baseUrl+"/events/"+e.event._id,e.triggeredCell).then(function(t){if(t.data.status==2002){e.event={title:"",description:""};jQuery("#editEventModal").modal("hide");$.notify(t.data.message,"success");return}$.notify(t.data.message,"error")})};e.deleteEvent=function(e,t,a,o){if(confirm("Are you sure ?")){r.delete(n.baseUrl+"/events/"+o,{params:{weeksIndex:e,dayIndex:t,eventIndex:a}}).then(function(e){if(e.data.status==2003){$.notify(e.data.message,"success");return}$.notify(e.data.message,"error")})}};t.on("create_event",function(t){e.weeks[t.weeksIndex].days[t.dayIndex].events.push(t)});t.on("edit_event",function(t){e.weeks[t.weeksIndex].days[t.dayIndex].events[t.eventIndex].title=t.title;e.weeks[t.weeksIndex].days[t.dayIndex].events[t.eventIndex].description=t.description});t.on("delete_event",function(t){e.weeks[t.weeksIndex].days[t.dayIndex].events.splice(t.eventIndex,1)})}})();(function(){angular.module("calendarApp").controller("aboutCtrl",e);function e(){var e=this;e.pageHeader={title:"About calendar app"};e.main={content:"This is calendar app."}}})();(function(){angular.module("calendarApp").directive("navigation",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html"}}})();(function(){angular.module("calendarApp").directive("footerGeneric",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/footerGeneric/footerGeneric.template.html"}}})();(function(){angular.module("calendarApp").directive("pageHeader",e);function e(){return{restrict:"EA",scope:{content:"=content"},templateUrl:"/common/directives/pageHeader/pageHeader.template.html"}}})();